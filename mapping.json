{
  "settings":{
     "index":{
        "analysis":{
           "analyzer":{
              "analyzer_shingle":{
                 "tokenizer":"standard",
                 "filter":["standard", "lowercase", "filter_stop", "filter_shingle"]
              }
           },
           "filter":{
              "filter_shingle":{
                 "type":"shingle",
                 "max_shingle_size":5,
                 "min_shingle_size":2,
                 "output_unigrams":"true"
              },
              "filter_stop":{
                 "type":"stop"
              }
           }
        }
     }
  },
  "mappings": {
    "cve": {
      "properties": {
        "cvss:access-complexity": {
          "type": "text",
          "fields": { "keyword": { "type": "keyword" } }
        },
        "cvss:access-vector": {
          "type": "text",
          "fields": { "keyword": { "type": "keyword" } }
        },
        "cvss:authentication": {
          "type": "text",
          "fields": { "keyword": { "type": "keyword" } }
        },
        "cvss:availability-impact": {
          "type": "text",
          "fields": { "keyword": { "type": "keyword" } }
        },
        "cvss:confidentiality-impact": {
          "type": "text",
          "fields": { "keyword": { "type": "keyword" } }
        },
        "cvss:generated-on-datetime": {
          "type": "date"
        },
        "cvss:integrity-impact": {
          "type": "text",
          "fields": { "keyword": { "type": "keyword" } }
        },
        "cvss:score": {
          "type": "long"
        },
        "cvss:source": {
          "type": "text",
          "fields": { "keyword": { "type": "keyword" } }
        },
        "cwe": {
          "type": "text",
          "fields": { "keyword": { "type": "keyword" } }
        },
        "description": {
          "type": "text",
          "fielddata" : "true",
          "analyzer":"analyzer_shingle",
          "fields": { "keyword": { "type": "keyword" } }
        },
        "fromCVE": { "type": "long" },
        "fromNVD": { "type": "long" },
        "id": { "type": "long" },
        "year": { "type": "long" },
        "product": {
          "type": "text",
          "fields": { "keyword": { "type": "keyword" } }
        }
      }
    }
  }
}
